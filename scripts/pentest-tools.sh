#!/bin/bash
# ═══════════════════════════════════════════════════════════════════════════════
# Pentest Tools Scanner - Finds installed blackarch tools
# ═══════════════════════════════════════════════════════════════════════════════

# Known pentest tool mappings (tool -> category, gui)
declare -A TOOL_CATEGORIES=(
    # Reconnaissance
    ["nmap"]="RECON:false"
    ["masscan"]="RECON:false"
    ["subfinder"]="RECON:false"
    ["amass"]="RECON:false"
    ["theHarvester"]="RECON:false"
    ["dnsenum"]="RECON:false"
    ["dnsrecon"]="RECON:false"
    ["fierce"]="RECON:false"
    ["recon-ng"]="RECON:false"
    ["spiderfoot"]="RECON:true"
    ["maltego"]="RECON:true"
    ["shodan"]="RECON:false"
    ["whatweb"]="RECON:false"
    ["wafw00f"]="RECON:false"
    
    # Web Application
    ["burpsuite"]="WEB:true"
    ["zaproxy"]="WEB:true"
    ["nikto"]="WEB:false"
    ["sqlmap"]="WEB:false"
    ["wpscan"]="WEB:false"
    ["dirb"]="WEB:false"
    ["dirbuster"]="WEB:true"
    ["gobuster"]="WEB:false"
    ["feroxbuster"]="WEB:false"
    ["ffuf"]="WEB:false"
    ["nuclei"]="WEB:false"
    ["httpx"]="WEB:false"
    ["wfuzz"]="WEB:false"
    ["xsstrike"]="WEB:false"
    ["commix"]="WEB:false"
    
    # Exploitation
    ["metasploit"]="EXPLOIT:false"
    ["msfconsole"]="EXPLOIT:false"
    ["searchsploit"]="EXPLOIT:false"
    ["exploitdb"]="EXPLOIT:false"
    ["beef"]="EXPLOIT:true"
    ["social-engineer-toolkit"]="EXPLOIT:false"
    ["setoolkit"]="EXPLOIT:false"
    ["empire"]="EXPLOIT:false"
    ["covenant"]="EXPLOIT:true"
    
    # Password Attacks
    ["hashcat"]="PASSWORD:false"
    ["john"]="PASSWORD:false"
    ["hydra"]="PASSWORD:false"
    ["medusa"]="PASSWORD:false"
    ["ncrack"]="PASSWORD:false"
    ["ophcrack"]="PASSWORD:true"
    ["cewl"]="PASSWORD:false"
    ["crunch"]="PASSWORD:false"
    ["hashid"]="PASSWORD:false"
    ["hash-identifier"]="PASSWORD:false"
    
    # Wireless
    ["aircrack-ng"]="WIRELESS:false"
    ["airodump-ng"]="WIRELESS:false"
    ["wifite"]="WIRELESS:false"
    ["reaver"]="WIRELESS:false"
    ["bully"]="WIRELESS:false"
    ["kismet"]="WIRELESS:true"
    ["fern-wifi-cracker"]="WIRELESS:true"
    ["fluxion"]="WIRELESS:false"
    
    # Forensics
    ["volatility"]="FORENSIC:false"
    ["volatility3"]="FORENSIC:false"
    ["autopsy"]="FORENSIC:true"
    ["sleuthkit"]="FORENSIC:false"
    ["foremost"]="FORENSIC:false"
    ["binwalk"]="FORENSIC:false"
    ["scalpel"]="FORENSIC:false"
    ["bulk_extractor"]="FORENSIC:false"
    ["wireshark"]="FORENSIC:true"
    ["tcpdump"]="FORENSIC:false"
    ["tshark"]="FORENSIC:false"
)

# Build JSON output
echo -n '{"tools":['

first=true
for tool in "${!TOOL_CATEGORIES[@]}"; do
    if command -v "$tool" &>/dev/null; then
        IFS=':' read -r category gui <<< "${TOOL_CATEGORIES[$tool]}"
        
        if [ "$first" = true ]; then
            first=false
        else
            echo -n ','
        fi
        
        echo -n "{\"name\":\"$tool\",\"category\":\"$category\",\"gui\":$gui}"
    fi
done

echo ']}'
